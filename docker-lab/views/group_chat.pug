doctype html
html
  head
    title Group Chat
    link(rel="stylesheet" href="/css/styles.css")

  body
    .container
      header
        h1 Group Chat: #{group.name}

      // Chat messages display area
      section.chat-area
        ul#chat-messages
          // Chat messages will be populated here

      // Message input and send button
      section.message-input
        form#chat-form(action="#" method="post")
          input(type="text" id="message-input" placeholder="Type a message")
          button(type="submit") Send

      // Navigation Button
      footer.navigation
        button.button(onclick="location.href='/chat'") Back to Chat Page

    // Include Socket.io script
    script(src="/socket.io/socket.io.js")
    script.
      var socket = io();
      var groupId = '#{group._id}';
      var userId = '#{userId}';

      socket.on('connect', () => {
        // Register the user and group with the server
        socket.emit('registerGroup', groupId, userId);
      });

      // Function to display a chat message
      function displayMessage(sender, message) {
        var chatMessages = document.getElementById('chat-messages');
        var messageItem = document.createElement('li');
        messageItem.textContent = sender + ": " + message;
        chatMessages.appendChild(messageItem);
      }

      // Handle form submission (sending messages)
      var chatForm = document.getElementById('chat-form');
      var messageInput = document.getElementById('message-input');

      chatForm.addEventListener('submit', function(e) {
        e.preventDefault();
        var messageText = messageInput.value.trim();
        if (messageText) {
          socket.emit('groupChatMessage', { groupId, senderUserId: userId, text: messageText });
          displayMessage('You', messageText);
          messageInput.value = '';
        }
      });

      // Handle incoming chat messages from the server
      socket.on('groupChatMessage', function(message) {
        if (message.group === groupId) {
          displayMessage(message.sender === userId ? 'You' : message.sender, message.message);
        }
      });
